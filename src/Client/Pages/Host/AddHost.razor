@page "/host/add"
@using System.ComponentModel.DataAnnotations
@layout NoGlobalSearchLayout
@namespace Shared
@using Host
@using Specification
@inject IHostService hostService
@inject NavigationManager Navigation

@attribute [Authorize(Roles = "Master, Administrator")]

<PageTitle>Host Toevoegen</PageTitle>

<EditForm @ref="Editform" Model="@Host">
    <div class="context-menu">
        <span class="context-menu-label">Host Toevoegen</span>
        <Button Text="Toevoegen" OnClick="@HandleValidSubmit" />
    </div>
    <DataAnnotationsValidator />
    <div class="three-column-layout">
        <div class="one-third">
            <Title Text="Algemene informatie" />

            <AddInput Type="@Input.InputType.TEXT" Label="Naam" Required="@true" @bind-Value="Host.Name" For="@(()=>Host.Name)" />

            <CustomInputNumber label="vcpu" required="@true" @bind-Value="Host.Specifications.Processors" For="@(()=>Host.Specifications.Processors)" />
            <CustomInputNumber label="opslag" required="@true" @bind-Value="Host.Specifications.Storage" For="@(()=>Host.Specifications.Storage)" />
            <CustomInputNumber label="geheugen"  required="@true" @bind-Value="Host.Specifications.Memory" For="@(()=>Host.Specifications.Memory)" />

        </div>
        <div class="one-third" ></div>
        <div class="one-third" ></div>
    </div>
</EditForm>

@code {
    private EditForm? Editform { get; set; } = new();
    private HostDto.Details Host { get; set; } = new();

    private async void HandleValidSubmit(){
        if (Editform.EditContext.Validate())
        {
            Console.WriteLine(Host.Specifications.Memory);
            HostDto.Details newHost = await hostService.Add(Host);
            Navigation.NavigateTo("host/" + newHost.Id);
        }
    }
}

}
